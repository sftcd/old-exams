<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
       "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>A (2004)</title>
  <meta name="generator" content="amaya 8.1a, see http://www.w3.org/Amaya/" />
</head>

<body>
<h1>NDS106 Unit1 (Security) Exam Sample Answers</h1>

<p>Stephen Farrell (<a
href="mailto:stephen.farrell@cs.tcd..ie">stephen.farrell@cs.tcd.ie</a>)
2004-02-20</p>

<h2><b>Question 1.</b></h2>

<p><b>a) Describe what are, in your opinion, three of the most important
vulnerabilities currently affecting distributed systems. In each case,
recommend and describe a (set of) countermeasue(s) which can reduce the risk
associated with the vulnerability and comment on any associated
implementation and/or deployment issues. (15)</b></p>

<p>Marking scheme: 5 points for each of the three; 2 for
completeness/correctness of the description of the vulnerability; 2 for
completeness/correctness of the description of the countermeasures and 1 for
sensible discussion of deployment issues.</p>

<p>Examples of the type of vulnerability which could be used include:</p>
<ul>
  <li>buffer overruns</li>
  <li>insecure default configurations</li>
  <li>tunneling application traffic via port 80</li>
  <li>running untrusted code on unprotected systems thus allowing large scale
    for DDoS</li>
  <li>a specific vulberability like SQL slammer</li>
  <li>an abstract vulnerability like "Microsoft's inclusion of scripting in
    many applications"</li>
</ul>

<p>An example of the description of SQL slammer from CERT-2003-04 and related
material is below. I would not expect the same level of detail, but all major
points should be mentioned to get full marks.</p>

<blockquote>
  <p>The vulnerability:</p>

  <p>The SQL Server Resolution Service (SSRS) was introduced in Microsoft SQL
  Server 2000 to provide referral services for multiple server instances
  running on the same machine. The service listens for requests on UDP port
  1434 and returns the IP address and port number of the SQL server instance
  that provides access to the requested database. The SSRS contains a stack
  buffer overflow that allows an attacker to execute arbitrary code by
  sending a crafted request to port 1434/udp. The code within such a request
  will be executed by the server host with the privileges of the SQL Server
  service account.</p>

  <p>The exploit:</p>

  <p>The propagation of this malicious code has caused varied levels of
  network degradation across the Internet and the compromise of vulnerable
  machines.</p>

  <p>The worm targeting SQL Server computers is self-propagating malicious
  code that exploits the vulnerability described in VU#484891
  (CAN-2002-0649). This vulnerability allows for the execution of arbitrary
  code on the SQL Server computer due to a stack buffer overflow. Once the
  worm compromises a machine, it will try to propagate itself. The worm will
  craft packets of 376-bytes and send them to randomly chosen IP addresses on
  port 1434/udp. If the packet is sent to a vulnerable machine, this victim
  machine will become infected and will also begin to propagate. Beyond the
  scanning activity for new hosts, the current variant of this worm has no
  other payload. Activity of this worm is readily identifiable on a network
  by the presence of 376-byte UDP packets. These packets will appear to be
  originating from seemingly random IP addresses and destined for port
  1434/udp.</p>

  <p>Compromise by the worm confirms a system is vulnerable to allowing a
  remote attacker to execute arbitrary code as the local SYSTEM user. It may
  be possible for an attacker to subsequently leverage a local privilege
  escalation exploit in order to gain Administrator access to the victim
  system. The high volume of 1434/udp traffic generated by hosts infected
  with the worm trying to find and compromise other SQL Server computers may
  itself lead to performance issues (including possible denial-of-service
  conditions) for Internet-connected hosts or for those computers on networks
  with compromise hosts.</p>

  <p>The counter:</p>

  <p>Use open source databases.</p>

  <p>Apply a patch from Microsoft.</p>

  <p>Ingress/Egress controls: The propagation of the worm requires a process
  listening on port 1434/udp to exploit this vulnerability. This precondition
  is obviously present in SQL Server 2000. However, not all applications
  using MSDE 2000 listen to the network by default. Therefore, only certain
  MSDE 2000-enabled applications may be vulnerable. Ingress/egress filtering
  The following steps are only effective in limiting the damage that can be
  done by systems already infected with the worm. They provide no protection
  against the initial infection of systems. As a result, these steps are only
  recommended in addition to the preventative steps outlined above. Ingress
  filtering manages the flow of traffic as it enters a network under your
  administrative control. Servers are typically the only machines that need
  to accept inbound traffic from the public Internet. In the network usage
  policy of many sites, external hosts are only permitted to initiate inbound
  traffic to machines that provide public services on specific ports. Thus,
  ingress filtering should be performed at the border to prohibit externally
  initiated inbound traffic to non-authorized services. Egress filtering
  manages the flow of traffic as it leaves a network under your
  administrative control. There is typically limited need for machines
  providing public services to initiate outbound connections to the Internet.
  In the case of this worm, employing ingress and egress filtering can help
  prevent compromised systems on your network from attacking systems
  elsewhere. Blocking UDP datagrams with both source or destination ports
  1434 from entering or leaving your network reduces the risk of external
  infected systems communicating with infected hosts inside your network.</p>
</blockquote>

<p><b>b) Justify the selectiion you made in part (a) (e.g. by comparing the
overall impact of the vulnerabilities you selected against other named
vulnerabilities) (5)</b></p>

<p>Marking scheme: 2 points for being believeable overall; 1 point for each
good argument to the effect that the selected vulnerabilities have higher
impact that other named vulnerabilities.</p>

<p><b>c) Outline an approach you might take during system design so that the
end product is less likely to suffer from exploitable vulnerabilities.
(5).</b></p>

<p>There are at least three reasonable approaches here - the ITSEC/CC
information assurance apprpoach, the firewalling/isolation approach and
(though less compelling) the formal systems approach.</p>

<p>Marking scheme: 1 point for the overall approach being reasonable; 2
points for correctness/completeness of description and 2 points for valid
arguments that the approach actually would reduce risk.</p>

<h2><b>Question 2.</b></h2>

<p><b>Alice works in a highly progressive county council which is planning to
web-enable its system for handling planning permission applications.</b></p>

<p><b>The system has to allow new planning applications to be entered either
by a member of the public or by a professional (e.g. architect, draftsperson)
on behalf of a member of the public. Applications consist of a number of
documents/drawings etc. which must meet many complex planning regulations (so
successfully entering a new application may require a few iterations). There
are fees which must be paid prior to entering a new application.</b></p>

<p><b>The system must allow for applications which are initially accepted to
be viewed by members of the public for a certain period and for planning
objections to be entered (and subsequently displayed). Planning objections
may come from members of the public who are likely to be affected by the
plan, or from certain other organisations (e.g. An Taisce or other
environmental concerns). Updates to the status of the plans may only be made
by planners, and details of such changes must be documented (e.g. a planner
may approve a plan but only subject to some changes). The system should be
designed so as to be as legally "robust" as possible, since Alice is well
aware that planning disputes often end up in court.</b></p>

<p><b>a) Describe an overall architecture for Alice's planning system, in
particular how each component affects the overall security of the system.
(10)</b></p>

<blockquote>
  <p>Overall clarity and correctness: 2 points.</p>

  <p>For a sensible network diagram: 2 points available. The answer should
  include a diagram showing the main hosts and network connections similar to
  that shown below, but need not have as much detail in terms of addressing
  and should have more detail in terms of the hosts (see below). The network
  diagram should separate out the following hosts/components</p>
  <ul>
    <li>DMZ dotted line</li>
    <li>Firewall</li>
    <li>Split-DNS (optional)</li>
    <li>Mail server/Web server</li>
    <li>Web application server</li>
    <li>"Payments" server</li>
    <li>Database server</li>
  </ul>

  <p><img src="mailserver_dmz.gif" /></p>

  <p>For including each of the following aspects within Alice's network, 1
  point, up to a max of 6:</p>
  <ul>
    <li>Separate physical interfaces on the firewall for inner,DMZ and ISP
      connections</li>
    <li>Having two different firewall "products" (possibly one simply using
      ipchains) so as to be less likely to fall victim to one single
      programming flaw</li>
    <li>Keeping customer information on a separate DB host on the inner
      network (or at least without direct access to the Internet)</li>
    <li>Stating the type of traffiic filtering that should be put in
    place</li>
    <li>Using a VPN for remote (and possibly 802.11) access</li>
    <li>Having a RADIUS server check for e.g. VPN logins</li>
    <li>Describing which traffic will be layered on top of SSL</li>
    <li>SSL crypto accellerators may be used</li>
    <li>Separating customer data to respect customer privacy (e.g. keeping
      CC# information separate from customer browsing patterns)</li>
    <li>Having a (monitored!) privacy policy</li>
    <li>2 additional points are available if the answer also describes
      additional major functional blocks in interesting levels of detail, for
      example:</li>
    <li>Describing a backup scheme</li>
    <li>Describing a disaster recovery scheme</li>
    <li>Describing load balancing if mandating SSL crypto hardware</li>
  </ul>
</blockquote>

<p><b>b) Describe how the various types of user of Alice's system might be
authenticated (note that no single authentication mechanism is likely to suit
all of these various type of user) and also describe the type(s) of
authorization technology which you would recommend that Alice should employ.
(10)</b></p>

<p>Marking scheme: 2 point for correctly identifying all of the types of
user; 1 point each (upto amax of 5) for picking a reasonable authentication
scheme for each type (e,g, reasonable includes username/password the public
and client-SSL for architects; but insisting on client-SSL for tghe public is
not reasonable); 1.5 points for a reasonable description of an authorization
scheme (which in this case can be quite simple - just ACLs and/or DB ACLs);
an additional 1.5 points for a good description of a better authorization
scheme (e.g. role based with SAML)</p>

<p><b>c) Describe how you could alleviate Alice's concerns with respect to
her having to defend her system in court during a planning dispute, but
without breaking the system or making it too cumbersome to use. (5)</b></p>

<p>One point for a sensible mention of each of the following:</p>
<ul>
  <li>keeping secure backups</li>
  <li>comprehensive auditing and logging</li>
  <li>digitally signing all versions of all documents (signing by system, not
    end users!)</li>
  <li>doing a "dry-run" at a court case before taking the system live incl.
    getting lawyer's opinion</li>
  <li>periodic tiger-team analysis of the system</li>
  <li>strict version controls on all software used</li>
  <li>insisting on source code escrow from suppliers</li>
  <li>taking out insurance or getting central Government to agree to
    indemnify Alice's council</li>
  <li>keeping a partial parallel paper based system until case-law becomes
    clear, or equivalent (e.g. requiring submitter to also print, manually
    sign and post an application)</li>
  <li>maintaining a testbed system so that demonstrations to the court can be
    done without affecting the live system (good for other reasons too of
    course)</li>
</ul>

<p>A point will be deducted for saying that every user should digitally sign
every document based on a strict PKI!</p>

<h2><b>Question 3.</b></h2>

<p><b>a) Discuss the use of cryptography in some practical key management
scheme (e.g. the SSL/TLS handshake or IPsec's IKEv2 or S/MIME), and describe
some of the advantages/pitfalls of how cryptography is used in your chosen
scheme. (15)</b></p>

<p>Marking scheme: 15 points available; for a complete description of one of
SSL/TLS, IPsec or S/MIME key management to the level provided below: 7
points; each obvious error is -1/2 point; 3 additional points for pros &amp;
cons according the list below; 2 points are for overall correctness/clarity
and 2 points for doing really well. The description below is the overview
section from the (4-th) IKEv2 draft. I'd hope for a bit more of the crypto to
be described but would be happy with this.</p>

<blockquote>
  <pre>   3 IKE Protocol Overview

   IP Security (IPsec) provides confidentiality, data integrity, access
   control, and data source authentication to IP datagrams. These
   services are provided by maintaining shared state between the source
   and the sink of an IP datagram. This state defines, among other
   things, the specific services provided to the datagram, which
   cryptographic algorithms will be used to provide the services, and
   the keys used as input to the cryptographic algorithms.

   Establishing this shared state in a manual fashion does not scale
   well.  Therefore a protocol to establish this state dynamically is
   needed.  This memo describes such a protocol-- the Internet Key
   Exchange (IKE).  This is version 2 of IKE. Version 1 of IKE was
   defined in RFCs 2407, 2408, and 2409. This single document is
   intended to replace all three of those RFCs.

   IKE performs mutual authentication between two parties and
   establishes an IKE security association that includes shared secret
   information that can be used to efficiently establish SAs for ESP
   (RFC 2406) and/or AH (RFC 2402).  It also negotiates use of IPcomp
   (RFC 2393) in connection with an ESP and/or AH SA.  We call the IKE
   SA an "IKE-SA". The SAs for ESP and/or AH that get set up through
   that IKE-SA we call "CHILD-SA"s.

   We call the first four messages establishing an IKE-SA a "phase 1"
   exchange and subsequent IKE exchanges "phase 2", inheriting this
   terminology from IKEv1. The phase 1 exchange establishes the IKE-SA
   and the first CHILD-SA. In some scenarios, only a single CHILD-SA is
   needed between the IPsec endpoints and therefore there would be no
   phase 2 exchanges. Phase 2 exchanges MAY be used to establish
   additional CHILD-SAs between the same authenticated pair of endpoints
   and to perform housekeeping functions.  The phase 1 exchange consists
   of two request/response pairs.  A phase 2 exchange is one
   request/response pair, and can be used to create or delete a CHILD-
   SA, rekey or delete the IKE-SA, or report information such as error
   conditions.

   IKE message flow always consists of a request followed by a response.
   It is the responsibility of the requester to ensure reliability.  If
   the response is not received within a timeout interval, the requester
   MUST retransmit the request (or abandon the connection).

   The first request/response of a phase 1 exchange negotiates security
   parameters for the IKE-SA, sends nonces, and sends Diffie-Hellman
   values. We call the initial exchange IKE_SA_INIT (request and
   response).

   The second request/response, which we'll call IKE_AUTH transmits
   identities, proves knowledge of the secrets corresponding to the two
   identities, and sets up an SA for the first (and often only) AH
   and/or ESP CHILD-SA.

   Phase 2 exchanges each consist of a single request/response pair. The
   types of exchanges are CREATE_CHILD_SA (which creates a CHILD-SA), or
   an Informational exchange which deletes an SA, reports error
   conditions, or does other housekeeping.  All these messages require a
   response. An informational message with no payloads is commonly used
   as a check for liveness.

   In the description that follows, we assume that no errors occur.
   Modifications to the flow should errors occur are described in
   section 4.

3.1 Usage Scenarios

   IKE is expected to be used to negotiate ESP and/or AH SAs in a number
   of different scenarios, each with their own special requirements.

3.1.1 Gateway to Gateway Tunnel

                    +-+-+-+-+-+            +-+-+-+-+-+
                    !         ! IPsec      !         !
       Protected    !Tunnel   ! Tunnel     !Tunnel   !     Protected
	      Subnet   ----!Endpoint !------------!Endpoint !---- Subnet
                    !         !            !         !
                    +-+-+-+-+-+            +-+-+-+-+-+

                       Figure 1:  Firewall to Firewall Tunnel

   In this scenario, neither endpoint of the IP connection implements
   IPsec, but network nodes between them protect traffic for part of the
   way. Protection is transparent to the endpoints, and depends on
   ordinary routing sending packets through the tunnel endpoints for
   processing. Each endpoint would announce the set of addresses
   "behind" it, and packets would be sent in Tunnel Mode where the inner
   IP header would contain the IP addresses of the actual endpoints.

3.1.2 Endpoint to Endpoint Transport

       +-+-+-+-+-+                                          +-+-+-+-+-+
       !         !                 IPsec                    !         !
       !Protected!                 Tunnel                   !Protected!
	      !Endpoint !------------------------------------------!Endpoint !
       !         !                                          !         !
       +-+-+-+-+-+                                          +-+-+-+-+-+

                       Figure 2:  Endpoint to Endpoint

   In this scenario, both endpoints of the IP connection implement
   IPsec. These endpoints may implement application layer access
   controls based on the authenticated identities of the participants.
   Transport mode will commonly be used with no inner IP header. If
   there is an inner IP header, the inner addresses will be the same as
   the outher addresses. A single pair of addresses will be negotiated
   for packets to be sent over this SA.

   It is possible in this scenario that one of the protected endpoints
   will be behind a network address translation (NAT) node, in which
   case the tunnelled packets will have to be UDP encapsulated so that
   port numbers in the UDP headers can be used to identify individual
   endpoints "behind" the NAT.

3.1.3 Endpoint to Gateway Transport

       +-+-+-+-+-+                          +-+-+-+-+-+
       !         !         IPsec            !         !     Protected
       !Protected!         Tunnel           !Tunnel   !     Subnet
   	   !Endpoint ! -------------------------!Endpoint ! ---- and/or
       !         !                          !         !     Internet
       +-+-+-+-+-+                          +-+-+-+-+-+

                       Figure 3:  Endpoint to Gateway

   In this scenario, a protected endpoint (typically a portable roaming
   computer) connects back to its corporate network through an IPsec
   protected tunnel. It might use this tunnel only to access information
   on the corporate network or it might tunnel all of its traffic back
   through the corporate network in order to take advantage of
   protection provided by a corporate firewall against Internet based
   attacks. In either case, the protected endpoint will want an IP
   address associated with the gateway so that packets returned to it
   will go to the gateway and be tunnelled back. This IP address may be
   static or may be dynamically allocated by the gateway. In support of
   the latter case, IKEv2 includes a mechanism for the initiator to
   request an IP address owned by the gateway for use for the duration
   of its SA.

   In this scenario, packets will use tunnel mode. On each packet from
   the protected endpoint, the outer IP header will contain the source
   IP address associated with its current location (i.e. the address
   that will get traffic routed to the endpoint directly) while the
   inner IP header will contain the source IP address assigned by the
   gateway (i.e. the address that will get traffic routed to the gateway
   for forwarding to the endpoint). The outer destination address will
   always be that of the gateway, while the inner destination address
   will be the ultimate destination for the packet.

   In this scenario, it is possible that the protected endpoint will be
   behind a NAT. In that case, the IP address as seen by the gateway
   will not be the same as the IP address sent by the protected
   endpoint, and packets will have to be UDP encapsulated in order to be
   routed properly.

3.1.4 Other Scenarios

   Other scenarios are possible, as are nested combinations of the
   above.  One noteable example combines aspects of 3.1.1 and 3.1.3. A
   subnet may make all external accesses through a remote gateway using
   an IPsec tunnel, where the addresses on the subnet are routed to the
   gateway by the rest of the Internet. An example would be someones
   home network being virtually on the Internet with static IP addresses
   even though connectivity is provided by an ISP that assigns a single
   dynamically assigned IP address (where the static IP addresses and an
   IPsec relay is provided by a third party located elsewhere).</pre>
</blockquote>

<p><b>b) Define and describe the "Electronic Code Book " and "Cipher Block
Chaining" modes of operation of block ciphers and give examples of when each
is suited for, and not suited for, use. (5)</b></p>

<p>Marking scheme:1 point for two good definitions; 1 point for each good
description; 1 bonus point for correct discussion of error propogation in
CBC; 2 points for good description ofwhen ECB/CBC suitable.</p>

<p><b>c) Describe some of the implementation options for private or secret
key storage and use and their consequences (5)</b></p>

<p>Main options are software/smartcard/other token (usb)/PCI card
h/w/networked or serial h/w</p>

<p>For each of the main options identified (I'd expect three) 0.5 points for
naming it and 0.5 points for a good description; 1 point for general
description of consequences (e.g. initializing h/w costs; speed;) and 1 bonus
point for identifying more obscure options (e.g. IBE, split keys, credential
servers). </p>

<p></p>

<p></p>

<p></p>
</body>
</html>
